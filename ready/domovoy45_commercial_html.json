{
	"_comment" : "не собираются сегмент+заглушки в таблице",
    "_task_id" : "DOMOVOI_test_1",
    "_start_urls" : [
		"https://dom45.ru/index.php?topic_id=180&optype=1&city_id=3",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=4",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=57",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=50",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=51",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=52",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=53",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=54",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=55",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=56",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=58",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=59",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=60",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=61",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=62",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=63",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=64",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=65",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=66",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=67",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=68",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=69",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=70",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=71",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=72",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=73",
        "https://dom45.ru/index.php?topic_id=180&optype=1&city_id=86",

        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=3",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=4",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=57",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=50",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=51",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=52",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=53",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=54",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=55",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=56",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=58",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=59",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=60",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=61",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=62",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=63",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=64",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=65",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=66",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=67",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=68",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=69",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=70",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=71",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=72",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=73",
        "https://dom45.ru/index.php?topic_id=180&optype=3&city_id=86",

        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=3",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=4",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=57",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=50",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=51",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=52",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=53",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=54",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=55",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=56",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=58",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=59",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=60",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=61",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=62",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=63",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=64",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=65",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=66",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=67",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=68",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=69",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=70",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=71",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=72",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=73",
        "https://dom45.ru/index.php?topic_id=170&optype=1&city_id=86",

        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=3",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=4",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=57",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=50",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=51",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=52",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=53",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=54",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=55",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=56",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=58",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=59",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=60",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=61",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=62",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=63",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=64",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=65",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=66",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=67",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=68",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=69",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=70",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=71",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=72",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=73",
        "https://dom45.ru/index.php?topic_id=170&optype=3&city_id=86"
    ],
    "_segment" : "",
    "_operation" : "",
    "_federal_subject" : "",
    "_source": "DOMOVOI",
    "global_settings" : {
        "CONCURRENT_REQUESTS" : 256,
        "CONCURRENT_REQUESTS_PER_DOMAIN" : 256,
        "DOWNLOAD_TIMEOUT" : 60,
        "SPLASH_URL" : "http://0.0.0.0:8050",
        "LOG_LEVEL" : "INFO",
        "AUTOTHROTTLE_ENABLED" : false,
        "AUTOTHROTTLE_START_DELAY" : 1.0,
        "AUTOTHROTTLE_MAX_DELAY" : 60,
        "AUTOTHROTTLE_TARGET_CONCURRENCY" : 256,
        "HTTPERROR_ALLOWED_CODES" : [],
        "RETRY_ENABLED" : true,
        "RETRY_TIMES" : 100,
        "RETRY_HTTP_CODES" : [
            500,
            503,
            504,
            400,
            403,
            408,
            429,
            505,
            404,
            303,
            302,
			301
        ],
        "ROBOTSTXT_ENABLED" : false,
        "ROBOTSTXT_OBEY" : false,
        "REDIRECT_ENABLED" : false,
        "COOKIES_ENABLED" : false,
        "RANDOM_UA_TYPE" : "random"
    },
    "methods" : {
        "crawling_type" : "common",
        "allowed_domains" : [],
        "filter_duplicates": false,
        "proxy_settings" : {
            "types" : [
                "https"
            ],
            "amount": 10000
        }
    },
    "crawl_tree": [{
        "pagination_urls": {
            "path": "(//span[@class='pagenav']/parent::li/following-sibling::li/a/@href)[1]"
        },
        "item_urls": {
            "path": "//div[@id='gridwrap']//div[@class='row-fluid']/div[@class='span3']/a/@href",
            "methods": {"filter_duplicates": false}
        }
    }],
    "item_page" : {
        "fields" : {
            "date_info" : {
                "type" : "date",
                "time" : "now"
            },
			"title_name" : {
                "type" : "string",
                "path" : "//div[@class='row-fluid']//div[@class='span12 price']//h3//text()"
            },
			"description" : {
				"type" : "list to string",
				"path": "(//div[@class='row-fluid']//p//text())[1]"
			},
            "operation" : {
				"type" : "list to string",
				"path": "//ul[@class='realty-options']/comment()",
                "regex": "Сдам|Продам"
			},
			"seller_company" : {
				"type" : "string",
				"path": "//div[@class='avtor']//h4//text()"
			},
            "seller_name" : {
				"type" : "string",
				"path": "//span[@class='ffio']/text()[normalize-space()]"
			},
			"phone" : {
				"type" : "phone",
				"xpath": "//div[@class='rv_phone phonenr']//span//text()"
			},
			"date_created" : {
                "type" : "date",
                "path" : "//div[@class='advdesc']/text()",
				"regex" : "Опубликовано: (.+). Просмотров",
				"time" : "from string"
            },
			"date_updated" : {
                "type" : "date",
                "path" : "//div[@class='advdesc']/text()",
				"regex" : "Обновлено: (.+). Опубликовано",
				"time" : "from string"
            },
			"source_longitude" :{
				"type" : "float",
				"path": "//script[text()[contains(.,'center')]]//text()",
				"regex" : ", (\\d*\\W?\\d+\\W?\\d+)\\],\\s*behaviors:"
			},
			"source_latitude" :{
				"type" : "float",
				"path": "//script[text()[contains(.,'center')]]//text()",
				"regex": "center: \\[(\\d*\\W?\\d+\\W?\\d+),"
			},
			"price": {
				"type" : "float",
				"path": "//div[@class='row-fluid']//div[@class='span12 price']//h3//text()",
				"regex": "Цена - (.+) руб"
            },
			"price_currency": {
				"type" : "float",
				"path": "//div[@class='row-fluid']//div[@class='span12 price']//h3//text()",
				"regex": "[А-Яа-я.\\W]+$"
			},
			"segment": {
				"type" : "string",
                "path" : "//div[@class='row-fluid']//div[@class='span12 price']//h3//text()",
				"regex" : "Коммерческая"
			},
            "purpose": {
				"type" : "string",
                "path" : "//div[@class='row-fluid']//div[@class='span12 price']//h3//text()",
				"regex" : "свободного назначения|офисная|торговая|складская|производственная|ГСК|парковка|отдельностоящ"
			}
        },
		 "tables" : {
			"table_1" : {
                "_keys_path" : "//div[@class='row-fluid']//li//label/text()",
                "_vals_path" : "//div[@class='row-fluid']//li//span/text()",
				"key_converter" : {
					"город": {
						"name": "address_city",
						"type" : "string"
					},
					"комнат": {
						"name": "count_rooms",
						"type" : "float",
						"regex": "\\d*\\W?\\d+"
					},
					"материал_стен": {
						"name": "walls_material",
						"type" : "string"
					},
					"площадь": {
						"name": ["area_total", "area_unit"],
						"type" : ["float", "string"],
						"regex": ["\\d*\\W?\\d+", "[А-Яа-я \\W]+"]
					},
                    "площадь_жилая": {
						"name": "square_living",
						"type" : "float",
						"regex":"\\d*\\W?\\d+"
					},
					"площадь_кухни": {
						"name": "square_kitchen",
						"type" : "float",
						"regex":"\\d*\\W?\\d+"
					},
					"площадь_участка": {
						"name": ["areal_land", "area_land_unit"],
						"type" : ["float", "string"],
						"regex": ["\\d*\\W?\\d+", "[А-Яа-я \\W]+"]
					},
					"район": {
						"name": "district",
						"type" : "string"
					},
					"улица": {
						"name": "address_street",
						"type" : "string"
					},
					"этаж": {
						"name": ["floor", "floors"],
						"type" : ["float","float"],
						"regex": ["(.+)\/","\/(.+)"]
					},
					"балкон": {
						"name": "is_balcony",
						"type" : "string"
					},
					"мебель": {
						"name": "is_furniture",
						"type" : "string"
					},
					"планировка": {
						"name": "floor_layout",
						"type" : "string"
					},
					"санузел": {
						"name": "is_bathroom",
						"type" : "string"
					},
					"свет": {
						"name": "is_electricity",
						"type" : "string"
					},
					"ориентир": {
						"name": "none",
						"type" : "string"
					},
					"плита": {
						"name": "none",
						"type" : "string"
					}
				}
			}
		}
    }
}


